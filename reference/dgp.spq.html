<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generation of qualitative process with spatial structure — dgp.spq • spqdep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generation of qualitative process with spatial structure — dgp.spq"><meta name="description" content="The purpose of the function dgp.spq is to generate a random dataset
with the dimensions and spatial structure decided by the user. This function may be
useful in pure simulation experiments or with the aim of showing specific properties
and characteristics of a spatial qualitative dataset."><meta property="og:description" content="The purpose of the function dgp.spq is to generate a random dataset
with the dimensions and spatial structure decided by the user. This function may be
useful in pure simulation experiments or with the aim of showing specific properties
and characteristics of a spatial qualitative dataset."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spqdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/user-guide.html">User Guide</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/f8l5h9/spqdep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generation of qualitative process with spatial structure</h1>
      <small class="dont-index">Source: <a href="https://github.com/f8l5h9/spqdep/blob/main/R/dgp.spq.R" class="external-link"><code>R/dgp.spq.R</code></a></small>
      <div class="d-none name"><code>dgp.spq.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The purpose of the function <code>dgp.spq</code> is to generate a random dataset
with the dimensions and spatial structure decided by the user. This function may be
useful in pure simulation experiments or with the aim of showing specific properties
and characteristics of a spatial qualitative dataset.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dgp.spq</span><span class="op">(</span>listw <span class="op">=</span> <span class="va">listw</span>, p <span class="op">=</span> <span class="va">p</span>,  rho <span class="op">=</span> <span class="va">rho</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>A <code>listw</code> object of the class nb, knn, listw o matrix created
for example by
<code><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></code> from <span class="pkg">spatialreg</span> package; if
<code><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></code> not given, set to
the same spatial weights as the <code>listw</code> argument. It can
also be a spatial weighting matrix of order <em>(NxN)</em> instead of
a <code>listw</code> object. Default = <code>NULL</code>.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>a vector with the percentage of elements of each categories.
The lengths must be the number of categories.
The sum of the elements of vector must be 1.</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>the level of spatial dependence (values between -1 y 1)</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>List of additional control arguments. See control argument section.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a factor of length N (<code>listw</code> is a matrix of order <em>(NxN)</em>) with
levels the first capital letters: "A", "B", ....</p>
<p>The description of the DGP is available in Páez et al. 2010 (pag 291) and in details section.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In order to obtain categorical random variables with controlled degrees
of spatial dependence, we have designed a two- stage data generating process:<br><br>
Firstly, we simulate autocorrelated data using the following model:
$$Y = (I - \rho W)^{-1} \epsilon$$
where \(\epsilon = N(0,1)\) I is the \(N \times N\) identity matrix, \(\rho\) is a parameter
of spatial dependence, and <em>W</em> is a connectivity matrix that
determines the set of spatial relationships among points.<br><br>
In the second step of the data generation process, the continuous spatially
autocorrelated variable Y is used to define a discrete spatial process
as follows. Let \(b_{ij}\) be defined by:<br>
$$p(Y \leq b_{ij})= {i \over j} \ \ \ with \ \ \ i&lt;j$$
Let \(A =\{a_1,a_2,...,a_k\}\) and define the discrete spatial process as:
$$X_s=a_1 \ \ \ if \ \ \ Y_s \leq b_{1k}$$
$$X_s=a_i \ \ \ if \ \ \ b_{i-1k} &lt; Y_s \leq b_{ik}$$
$$X_s=a_k \ \ \ if \ \ \ Y_s &gt; b_{k-1k}$$</p>
    </div>
    <div class="section level2">
    <h2 id="control-arguments">Control arguments<a class="anchor" aria-label="anchor" href="#control-arguments"></a></h2>


<dl><dt>seedinit</dt>
<dd><p>seed to generate the data sets</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Ruiz M, López FA, A Páez. (2010). <em>Testing for spatial association of qualitative
data using symbolic dynamics</em>. Journal of Geographical Systems. 12 (3) 281-309</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Q.test.html">Q.test</a></code>, <code><a href="Q.map.test.html">Q.map.test</a></code>, <code><a href="sp.runs.test.html">sp.runs.test</a></code>, <code><a href="scan.test.html">scan.test</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>

<table class="table table"><tr><td>Fernando López</td><td><a href="mailto:fernando.lopez@upct.es">fernando.lopez@upct.es</a></td></tr><tr><td>Román Mínguez</td><td><a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a></td></tr><tr><td>Antonio Páez</td><td><a href="mailto:paezha@gmail.com">paezha@gmail.com</a></td></tr><tr><td>Manuel Ruiz</td><td><a href="mailto:manuel.ruiz@upct.es">manuel.ruiz@upct.es</a></td></tr></table></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html" class="external-link">knn2nb</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xf</span> <span class="op">&lt;-</span> <span class="fu">dgp.spq</span><span class="op">(</span>list <span class="op">=</span> <span class="va">listw</span>, p <span class="op">=</span> <span class="va">p</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="va">provinces_spain</span>, queen <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> although coordinates are longitude/latitude, st_intersects assumes that they</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> are planar</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>some observations have no neighbours;</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> if this seems unexpected, try increasing the snap argument.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 4 sub-graphs;</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> if this sub-graph count seems unexpected, try increasing the snap argument.</span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">=</span> <span class="fl">0.9</span></span></span>
<span class="r-in"><span><span class="va">xf</span> <span class="op">&lt;-</span> <span class="fu">dgp.spq</span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">xf</span> <span class="op">&lt;-</span> <span class="va">xf</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">[</span><span class="st">"xf"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dgp.spq-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fernando Lopez, Roman Minguez, Antonio Paez, Manuel Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

