<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>User Guide • spqdep</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="User Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spqdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/user-guide.html">User Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/f8l5h9/spqdep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>User Guide</h1>
                        <h4 data-toc-skip class="author">Fernando A.
López, Technical University of Cartagena (Spain)</h4>
                        <h4 data-toc-skip class="author">Román Mínguez,
University of Castilla-La Mancha (Spain)</h4>
                        <h4 data-toc-skip class="author">Antonio Páez,
McMaster University (Canada)</h4>
                        <h4 data-toc-skip class="author">Manuel Ruiz,
Technical University of Cartagena (Spain) <br><br><br>
</h4>
            
            <h4 data-toc-skip class="date">2025-09-19 <br>
</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/f8l5h9/spqdep/blob/main/vignettes/user-guide.Rmd" class="external-link"><code>vignettes/user-guide.Rmd</code></a></small>
      <div class="d-none name"><code>user-guide.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/" class="external-link">spatialreg</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This guide show the functionalities of the <strong>spqdep</strong>
package to test spatial dependence on qualitative datasets.</p>
<p>Global and local statistics give information about the spatial
structure of the spatial dataset.</p>
<div class="section level3">
<h3 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h3>
<p>Three data sets will be used as examples in this guide:</p>
<ul>
<li><p><strong>provinces_spain</strong>: The division of Spain into
provinces. It is a multypolygon geometry with isolated provinces (Canary
and Balearic islands without neighbouring provinces). See for example
<span class="citation">Paez et al. (<a href="#ref-paezSpatioTemporalAnalysisEnvironmental2021">2021</a>)</span>.</p></li>
<li><p><strong>FastFood.sf</strong>: A simple feature (sf) dataframe
containing the locations of a selection of fast food restaurants in the
city of Toronto, Canada (data are from 2008). The data set used as
example in <span class="citation">Ruiz, López, and Páez (<a href="#ref-ruiz2010">2010</a>)</span>. It is a geometry of
points.</p></li>
<li><p><strong>Boots.sf</strong>: A simple features object. A square
regular lattice 16x16 from Fig. 3.3 in <span class="citation">Upton and
Fingleton (<a href="#ref-upton1985">1985</a>)</span>. In this figure,
the cells coded black/white correspond to quadrats where the perennial
shrub Atriplex hymenelytra is present/absent in a sample area in Death
Valley, California.</p></li>
</ul>
<p>The package is install like usual and the dataset can be loaded using
the next code</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://f8l5h9.github.io/spqdep/">spqdep</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"provinces_spain"</span>, package <span class="op">=</span> <span class="st">"spqdep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"FastFood.sf"</span>, package <span class="op">=</span> <span class="st">"spqdep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Boots.sf"</span>, package <span class="op">=</span> <span class="st">"spqdep"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-generating-process">Data Generating Process<a class="anchor" aria-label="anchor" href="#data-generating-process"></a>
</h3>
<p>Additional to the datasets available in the <strong>spqdep</strong>
package. The user can generate structured spatial processes using the
function. The DGP generate with this function defined in <span class="citation">Ruiz, López, and Páez (<a href="#ref-ruiz2010">2010</a>)</span>.</p>
<p>The next code show how to generate a random process on a set of
random points localized in a square
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \times 1</annotation></semantics></math>.
In this case, the connectivity criteria is based on the 4 nearest
neighbourhood.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">cx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">cy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span> <span class="co"># proportion of classes</span></span>
<span><span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># level of spatial structure</span></span>
<span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html" class="external-link">knn2nb</a></span><span class="op">(</span><span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">listw</span>, p <span class="op">=</span> <span class="va">p</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span></code></pre></div>
<p>The next plot show the qualitative spatial process defined.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, cx <span class="op">=</span> <span class="va">cx</span>, cy <span class="op">=</span> <span class="va">cy</span><span class="op">)</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cx</span>, y <span class="op">=</span> <span class="va">cy</span>, color <span class="op">=</span> <span class="va">fx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="q-test">Q-test<a class="anchor" aria-label="anchor" href="#q-test"></a>
</h2>
<p>The Q-test is a simple, consistent, and powerful statistic for
qualitative spatial independence that we develop using concepts from
<strong>symbolic dynamics</strong> and <strong>symbolic
entropy</strong>. The Q test can be used to detect, given a spatial
distribution of events, patterns of spatial association of qualitative
variables in a wide variety of settings.</p>
<ul>
<li><p>The Q-test <span class="citation">(<a href="#ref-ruiz2010">Ruiz,
López, and Páez 2010</a>)</span> is based on m-surroundings</p></li>
<li><p>Before to apply the Q-test it is necessary define a set of the
m-surroundings</p></li>
<li><p>The function generate a set of m-surrounding.</p></li>
<li><p>The user can tuning several parameters to obtain a congruent set
of m-surroundings.</p></li>
</ul>
<p>The Q(m) statistic was introduced by <span class="citation">Ruiz,
López, and Páez (<a href="#ref-ruiz2010">2010</a>)</span> as a tool to
explore geographical co-location/co-occurrence of qualitative data.
Consider a spatial variable X which is the result of a qualitative
process with a set number of categorical outcomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>j</mi></msub><annotation encoding="application/x-tex">a_j</annotation></semantics></math>
(j=1,…,k). The spatial variable is observed at a set of fixed locations
indexed by their coordinates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>i</mi></msub><annotation encoding="application/x-tex">s_i</annotation></semantics></math>
(i=1,…, N), so that at each location si where an event is observed,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
takes one of the possible values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>j</mi></msub><annotation encoding="application/x-tex">a_j</annotation></semantics></math>.</p>
<p>Since the observations are georeferenced, a spatial embedding
protocol can be devised to assess the spatial property of co-location.
Let us define, for an observation at a specified location, say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mn>0</mn></msub><annotation encoding="application/x-tex">s_0</annotation></semantics></math>,
a surrounding of size m, called an m-surrounding. The m-surrounding is
the set of m-1 nearest neighbours from the perspective of location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mn>0</mn></msub><annotation encoding="application/x-tex">s_0</annotation></semantics></math>.
In the case of distance ties, a secondary criterion can be invoked based
on direction.</p>
<p>Once that an embedding protocol is adopted and the elements of the
m-surrounding for location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mn>0</mn></msub><annotation encoding="application/x-tex">s_0</annotation></semantics></math>
have been determined, a string can be obtained that collects the
elements of the local neighborhood (the m-1 nearest neighbors) of the
observation at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mn>0</mn></msub><annotation encoding="application/x-tex">s_0</annotation></semantics></math>.
The m-surrounding can then be represented in the following way:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><msub><mi>s</mi><mn>0</mn></msub></msub><mo>,</mo><msub><mi>X</mi><msub><mi>s</mi><mn>1</mn></msub></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><msub><mi>X</mi><msub><mi>s</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_m(s_0)=(X_{s_0},X_{s_1},...X_{s_{m-1}})</annotation></semantics></math></p>
<p>Since each observation Xs takes one of k possible values, and there
are m observations in the m-surrounding, there are exactly k possible
unique ways in which those values can co-locate. This is the number of
permutations with replacement. For instance, if k=2 (e.g. the possible
outcomes are a1=0 and a2=1) and m=3, the following eight unique patterns
of co-location are possible (the number of symbols is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>σ</mi></msub><annotation encoding="application/x-tex">n_{\sigma}</annotation></semantics></math>=8):
{0,0,0}, {1,0,0}, {0,1,0}, {0,0,1}, {1,1,0}, {1,0,1}, {0,1,1}, and
{1,1,1}. Each unique co-locationtype can be denoted in a convenient way
by means of a symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\sigma_i</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msup><mi>k</mi><mi>m</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i=1, 2,...,k^m)</annotation></semantics></math>.
It follows that each site can be uniquely associated with a specific
symbol, in a process termed symbolization. In this way, we say that a
location s is of type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\sigma_i</annotation></semantics></math>
if and only if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>σ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X_m(s)=\sigma_i</annotation></semantics></math>.
Equivalent symbols (see Páez, et al. 2012) can be obtained by counting
the number of occurrences of each category within an m-surrounding. This
surrenders some topological information (ordering within the
m-surrounding is lost) in favor of a more compact set of symbols, since
the number of combinations with replacement.</p>
<p><strong>Definition of Q(m) statistic</strong></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>s</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>s</mi><mo>∈</mo><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\{X_s\}_{s \in R}</annotation></semantics></math>
be a discrete spatial process and m be a fixed embedding dimension. The
statistic Q(m) testing the null hypothesis:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>s</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>s</mi><mo>∈</mo><mi>R</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\{X_s\}_{s \in R}</annotation></semantics></math>
is spatially independent, against any other alternative.</p>
<p>For a fixed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m \geq 2</annotation></semantics></math>,
the relative frequency of symbols can be used to define the symbolic
entropy of the spatial process as the Shanon entropy of the distinct
symbols:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mi>j</mi></munder><msub><mi>p</mi><msub><mi>σ</mi><mi>j</mi></msub></msub><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><msub><mi>σ</mi><mi>j</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(m) = - \sum_j p_{\sigma_j}ln(p_{\sigma_j})</annotation></semantics></math></p>
<p>where</p>
<p><span class="math display">$$p_{\sigma_j}={ n_{\sigma_j} \over
R}$$</span></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><msub><mi>σ</mi><mi>j</mi></msub></msub><annotation encoding="application/x-tex">n_{\sigma_j}</annotation></semantics></math>
is simply the number of times that the symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\sigma_j</annotation></semantics></math>
is observed and R the number of symbolized locations.</p>
<p>The entropy function is bounded between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>η</mi></mrow><annotation encoding="application/x-tex">0 &lt; h (m) \leq \eta</annotation></semantics></math>.</p>
<p>The Q statistic is essentially a likelihood ratio test between the
symbolic entropy of the observed pattern and the entropy of the system
under the null hypothesis of a random spatial sequence:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>2</mn><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo>−</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(m)=2R(\eta-h(m))</annotation></semantics></math></p>
<p>with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>k</mi><mi>m</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta = ln(k^m)</annotation></semantics></math>.
The statistic is asymptotically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
distributed with degrees of freedom equal to the number of symbols minus
one.</p>
<div class="section level3">
<h3 id="m-surroundings">m-surroundings<a class="anchor" aria-label="anchor" href="#m-surroundings"></a>
</h3>
<ul>
<li><p><strong>m.surround()</strong> is the function to generate
m-surroundings.</p></li>
<li><p>The output of this function is a object of the class
<strong>m_surr</strong></p></li>
<li><p>Using the method the user can explore the coherence of
m-surroundings because some times the algorithm can generate degenerate
m-surrounding with so far observations with the degree of overlapping is
low. The recommendation is use the control options.</p></li>
</ul>
<p><strong>The overlapping degree</strong></p>
<p>The performance of the statistic can become compromised due to the
overlap of m-surroundings. To meet all key approximations for testing,
the overlap is controlled by letting the maximum number of symbolized
locations S be less than the actual number of observations N,</p>
<p>When r = 0 (i.e., no overlap is allowed) we exactly have binomial
random variables. Note that the maximum number of locations that can be
symbolized with an overlapping degree r is</p>
<p><span class="math display">$$R = { [{{|S|−m} \over {m-r}} ]} +
1$$</span>,</p>
<p>where [x] denotes the integer part of a real number x, and |S| the
cardinality of the set S. Therefore, reducing the degree of overlap also
implies that the number of symbolized locations will be smaller than the
number of observations in the sample</p>
<p>By example, the next code obtain m-surroundings with length m = 3 and
degree of overlapping r = 1:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">mh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m.surround.html">m.surround</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cx</span>,<span class="va">cy</span><span class="op">)</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "m_surr" "list"</span></span></code></pre></div>
<div class="section level4">
<h4 id="methods-for-the-m_surr-class">Methods for the m_surr class<a class="anchor" aria-label="anchor" href="#methods-for-the-m_surr-class"></a>
</h4>
<p>The <strong>spqdep</strong> have three methods that can be apply to
this class: , and </p>
<div class="section level5">
<h5 id="the-print-method">The print method<a class="anchor" aria-label="anchor" href="#the-print-method"></a>
</h5>
<ul>
<li> list the m-surroundings</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]    1   19   17</span></span>
<span><span class="co">#&gt;  [2,]    2   65   53</span></span>
<span><span class="co">#&gt;  [3,]    3   42   77</span></span>
<span><span class="co">#&gt;  [4,]    4   11   26</span></span>
<span><span class="co">#&gt;  [5,]    6   18   85</span></span>
<span><span class="co">#&gt;  [6,]    7   79   93</span></span>
<span><span class="co">#&gt;  [7,]    8   21   31</span></span>
<span><span class="co">#&gt;  [8,]   13   58   68</span></span>
<span><span class="co">#&gt;  [9,]   15   98   74</span></span>
<span><span class="co">#&gt; [10,]   17   76   96</span></span>
<span><span class="co">#&gt; [11,]   20   87   24</span></span>
<span><span class="co">#&gt; [12,]   22   82   92</span></span>
<span><span class="co">#&gt; [13,]   25    9   61</span></span>
<span><span class="co">#&gt; [14,]   26   14    7</span></span>
<span><span class="co">#&gt; [15,]   27   72   13</span></span>
<span><span class="co">#&gt; [16,]   31    5   20</span></span>
<span><span class="co">#&gt; [17,]   37   73   89</span></span>
<span><span class="co">#&gt; [18,]   38   30   15</span></span>
<span><span class="co">#&gt; [19,]   41   91   62</span></span>
<span><span class="co">#&gt; [20,]   46   47   49</span></span>
<span><span class="co">#&gt; [21,]   48   43   55</span></span>
<span><span class="co">#&gt; [22,]   49   29   60</span></span>
<span><span class="co">#&gt; [23,]   52   86    3</span></span>
<span><span class="co">#&gt; [24,]   53   97   69</span></span>
<span><span class="co">#&gt; [25,]   55   28   27</span></span>
<span><span class="co">#&gt; [26,]   56   64   41</span></span>
<span><span class="co">#&gt; [27,]   57   35   63</span></span>
<span><span class="co">#&gt; [28,]   60   44   70</span></span>
<span><span class="co">#&gt; [29,]   61   78   94</span></span>
<span><span class="co">#&gt; [30,]   62   54   46</span></span>
<span><span class="co">#&gt; [31,]   63   83   75</span></span>
<span><span class="co">#&gt; [32,]   67   50   37</span></span>
<span><span class="co">#&gt; [33,]   68   84    2</span></span>
<span><span class="co">#&gt; [34,]   69   59   22</span></span>
<span><span class="co">#&gt; [35,]   70   12   99</span></span>
<span><span class="co">#&gt; [36,]   71   34   67</span></span>
<span><span class="co">#&gt; [37,]   74   51    6</span></span>
<span><span class="co">#&gt; [38,]   75   36  100</span></span>
<span><span class="co">#&gt; [39,]   77   88    8</span></span>
<span><span class="co">#&gt; [40,]   85   80   57</span></span>
<span><span class="co">#&gt; [41,]   89   32    4</span></span>
<span><span class="co">#&gt; [42,]   90   45   38</span></span>
<span><span class="co">#&gt; [43,]   92   23   25</span></span>
<span><span class="co">#&gt; [44,]   93   39   95</span></span>
<span><span class="co">#&gt; [45,]   94   33   71</span></span>
<span><span class="co">#&gt; [46,]   95   81   90</span></span>
<span><span class="co">#&gt; [47,]   96   40   56</span></span>
<span><span class="co">#&gt; [48,]   99   10   48</span></span>
<span><span class="co">#&gt; [49,]  100   66   52</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="the-summary-method">The summary method<a class="anchor" aria-label="anchor" href="#the-summary-method"></a>
</h5>
<ul>
<li> generate a summary of some characteristics of the
m-surroundings</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Characteristics of m-surrounding:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of m-surrounding (R): 49</span></span>
<span><span class="co">#&gt; Length of m-surrounding (m): 3</span></span>
<span><span class="co">#&gt; Number no-symbolized observations: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of no-symbolized observations:</span></span>
<span><span class="co">#&gt; 16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; List of the degree overlaping:</span></span>
<span><span class="co">#&gt;     There are 2 m-surrounding that have intersection with 1 m-surrounding</span></span>
<span><span class="co">#&gt;     There are 47 m-surrounding that have intersection with 2 m-surrounding</span></span>
<span><span class="co">#&gt; Mean degree of overlaping: 1.9592</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="the-plot-method">The plot method<a class="anchor" aria-label="anchor" href="#the-plot-method"></a>
</h5>
<ul>
<li> show the spatial structure of the m-surroundings</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mh</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/plot%20mh-1.png" width="700"></p>
<ul>
<li>With the argument <strong>control</strong> the user can tuning some
characteristics of the m-surroundings.</li>
</ul>
<p>By example, with <strong>control</strong> argument, the user can
‘prune’ non-coherent m-surroundings.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>dtmaxknn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">mh.prune</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m.surround.html">m.surround</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mh.prune</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/plot%20mh%20prune-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-q-test">The Q-test<a class="anchor" aria-label="anchor" href="#the-q-test"></a>
</h3>
<ul>
<li>The function obtain the Q-test for a spatial process develop in
<span class="citation">Ruiz, López, and Páez (<a href="#ref-ruiz2010">2010</a>)</span>.</li>
</ul>
<p>The user must select the longitude of the m-surroundings (m) and the
overlapping degree (r). In the next code example, the Q-test is obtain
for the DGP spatial process (fx) obtain with the . The coordinates
<strong>coor</strong> must be included as argument.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>The output is a list with the result for symbols based on
permutations (standard) and combinations (equivalent).</p></li>
<li><p>The output of this function is an object of the
<strong>spqtest</strong> class.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="distribution-of-q-test">Distribution of Q-test<a class="anchor" aria-label="anchor" href="#distribution-of-q-test"></a>
</h3>
<ul>
<li><p>The asymptotic distribution is the default distribution to obtain
the significance of Q-test <span class="citation">(<a href="#ref-ruiz2010">Ruiz, López, and Páez 2010</a>)</span>.</p></li>
<li><p>Alternatively, the Monte Carlo method can be used to obtain the
significance of the test. The paper <span class="citation">López and
Páez (<a href="#ref-lopez2012">2012</a>)</span> describe this
approach.</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q.test.mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span>, distr <span class="op">=</span> <span class="st">"mc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">q.test.mc</span><span class="op">)</span></span></code></pre></div>
<div id="mvomnquzwd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mvomnquzwd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mvomnquzwd thead, #mvomnquzwd tbody, #mvomnquzwd tfoot, #mvomnquzwd tr, #mvomnquzwd td, #mvomnquzwd th {
  border-style: none;
}

#mvomnquzwd p {
  margin: 0;
  padding: 0;
}

#mvomnquzwd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mvomnquzwd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mvomnquzwd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mvomnquzwd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mvomnquzwd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mvomnquzwd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mvomnquzwd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mvomnquzwd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mvomnquzwd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mvomnquzwd .gt_spanner_row {
  border-bottom-style: hidden;
}

#mvomnquzwd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mvomnquzwd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mvomnquzwd .gt_from_md > :first-child {
  margin-top: 0;
}

#mvomnquzwd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mvomnquzwd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mvomnquzwd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mvomnquzwd .gt_row_group_first td {
  border-top-width: 2px;
}

#mvomnquzwd .gt_row_group_first th {
  border-top-width: 2px;
}

#mvomnquzwd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mvomnquzwd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mvomnquzwd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mvomnquzwd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mvomnquzwd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvomnquzwd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvomnquzwd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvomnquzwd .gt_left {
  text-align: left;
}

#mvomnquzwd .gt_center {
  text-align: center;
}

#mvomnquzwd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mvomnquzwd .gt_font_normal {
  font-weight: normal;
}

#mvomnquzwd .gt_font_bold {
  font-weight: bold;
}

#mvomnquzwd .gt_font_italic {
  font-style: italic;
}

#mvomnquzwd .gt_super {
  font-size: 65%;
}

#mvomnquzwd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mvomnquzwd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mvomnquzwd .gt_indent_1 {
  text-indent: 5px;
}

#mvomnquzwd .gt_indent_2 {
  text-indent: 10px;
}

#mvomnquzwd .gt_indent_3 {
  text-indent: 15px;
}

#mvomnquzwd .gt_indent_4 {
  text-indent: 20px;
}

#mvomnquzwd .gt_indent_5 {
  text-indent: 25px;
}

#mvomnquzwd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mvomnquzwd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="9" class="gt_heading gt_title gt_font_normal" style>Qualitative Dependence Test (Q)</td>
    </tr>
<tr class="gt_heading">
<td colspan="9" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Distribution: mc. Distance: Euclidean</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q">Q</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="k">k</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="N">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="m">m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="R">R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="R/n">R/n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a5k^m">5k^m</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="9" class="gt_group_heading" scope="colgroup" id="V1 - standard-permutations">V1 - standard-permutations</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="V1 - standard-permutations  Q" class="gt_row gt_right">33.31</td>
<td headers="V1 - standard-permutations  p.value" class="gt_row gt_right">0.36100</td>
<td headers="V1 - standard-permutations  k" class="gt_row gt_right">3</td>
<td headers="V1 - standard-permutations  N" class="gt_row gt_right">100</td>
<td headers="V1 - standard-permutations  m" class="gt_row gt_right">3</td>
<td headers="V1 - standard-permutations  R" class="gt_row gt_right">100</td>
<td headers="V1 - standard-permutations  n" class="gt_row gt_right">27</td>
<td headers="V1 - standard-permutations  R/n" class="gt_row gt_right">3.70</td>
<td headers="V1 - standard-permutations  5k^m" class="gt_row gt_right">135</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="9" class="gt_group_heading" scope="colgroup" id="V1 - equivalent-combinations">V1 - equivalent-combinations</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="V1 - equivalent-combinations  Q" class="gt_row gt_right">19.89</td>
<td headers="V1 - equivalent-combinations  p.value" class="gt_row gt_right">0.28200</td>
<td headers="V1 - equivalent-combinations  k" class="gt_row gt_right">3</td>
<td headers="V1 - equivalent-combinations  N" class="gt_row gt_right">100</td>
<td headers="V1 - equivalent-combinations  m" class="gt_row gt_right">3</td>
<td headers="V1 - equivalent-combinations  R" class="gt_row gt_right">100</td>
<td headers="V1 - equivalent-combinations  n" class="gt_row gt_right">10</td>
<td headers="V1 - equivalent-combinations  R/n" class="gt_row gt_right">10.00</td>
<td headers="V1 - equivalent-combinations  5k^m" class="gt_row gt_right">135</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="methods-for-the-spqtest-class">Methods for the spqtest class<a class="anchor" aria-label="anchor" href="#methods-for-the-spqtest-class"></a>
</h4>
<p>A summary can be apply to an object of the spqtest class:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">q.test</span><span class="op">)</span></span></code></pre></div>
<div id="bxchperxsc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bxchperxsc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bxchperxsc thead, #bxchperxsc tbody, #bxchperxsc tfoot, #bxchperxsc tr, #bxchperxsc td, #bxchperxsc th {
  border-style: none;
}

#bxchperxsc p {
  margin: 0;
  padding: 0;
}

#bxchperxsc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bxchperxsc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bxchperxsc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bxchperxsc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bxchperxsc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bxchperxsc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bxchperxsc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bxchperxsc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bxchperxsc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bxchperxsc .gt_spanner_row {
  border-bottom-style: hidden;
}

#bxchperxsc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bxchperxsc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bxchperxsc .gt_from_md > :first-child {
  margin-top: 0;
}

#bxchperxsc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bxchperxsc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bxchperxsc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bxchperxsc .gt_row_group_first td {
  border-top-width: 2px;
}

#bxchperxsc .gt_row_group_first th {
  border-top-width: 2px;
}

#bxchperxsc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bxchperxsc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bxchperxsc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bxchperxsc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bxchperxsc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxchperxsc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxchperxsc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxchperxsc .gt_left {
  text-align: left;
}

#bxchperxsc .gt_center {
  text-align: center;
}

#bxchperxsc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bxchperxsc .gt_font_normal {
  font-weight: normal;
}

#bxchperxsc .gt_font_bold {
  font-weight: bold;
}

#bxchperxsc .gt_font_italic {
  font-style: italic;
}

#bxchperxsc .gt_super {
  font-size: 65%;
}

#bxchperxsc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bxchperxsc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bxchperxsc .gt_indent_1 {
  text-indent: 5px;
}

#bxchperxsc .gt_indent_2 {
  text-indent: 10px;
}

#bxchperxsc .gt_indent_3 {
  text-indent: 15px;
}

#bxchperxsc .gt_indent_4 {
  text-indent: 20px;
}

#bxchperxsc .gt_indent_5 {
  text-indent: 25px;
}

#bxchperxsc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bxchperxsc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="11" class="gt_heading gt_title gt_font_normal" style>Qualitative Dependence Test (Q)</td>
    </tr>
<tr class="gt_heading">
<td colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Distribution: asymptotic. Distance: Euclidean</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q">Q</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="k">k</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="N">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="m">m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="r">r</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="R">R</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="R/n">R/n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a5k^m">5k^m</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="11" class="gt_group_heading" scope="colgroup" id="V1 - standard-permutations">V1 - standard-permutations</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="V1 - standard-permutations  Q" class="gt_row gt_right">27.08</td>
<td headers="V1 - standard-permutations  df" class="gt_row gt_right">26</td>
<td headers="V1 - standard-permutations  p.value" class="gt_row gt_right">0.40522</td>
<td headers="V1 - standard-permutations  k" class="gt_row gt_right">3</td>
<td headers="V1 - standard-permutations  N" class="gt_row gt_right">100</td>
<td headers="V1 - standard-permutations  m" class="gt_row gt_right">3</td>
<td headers="V1 - standard-permutations  r" class="gt_row gt_right">1</td>
<td headers="V1 - standard-permutations  R" class="gt_row gt_right">49</td>
<td headers="V1 - standard-permutations  n" class="gt_row gt_right">27</td>
<td headers="V1 - standard-permutations  R/n" class="gt_row gt_right">1.81</td>
<td headers="V1 - standard-permutations  5k^m" class="gt_row gt_right">135</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="11" class="gt_group_heading" scope="colgroup" id="V1 - equivalent-combinations">V1 - equivalent-combinations</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="V1 - equivalent-combinations  Q" class="gt_row gt_right">11.70</td>
<td headers="V1 - equivalent-combinations  df" class="gt_row gt_right">9</td>
<td headers="V1 - equivalent-combinations  p.value" class="gt_row gt_right">0.23065</td>
<td headers="V1 - equivalent-combinations  k" class="gt_row gt_right">3</td>
<td headers="V1 - equivalent-combinations  N" class="gt_row gt_right">100</td>
<td headers="V1 - equivalent-combinations  m" class="gt_row gt_right">3</td>
<td headers="V1 - equivalent-combinations  r" class="gt_row gt_right">1</td>
<td headers="V1 - equivalent-combinations  R" class="gt_row gt_right">49</td>
<td headers="V1 - equivalent-combinations  n" class="gt_row gt_right">10</td>
<td headers="V1 - equivalent-combinations  R/n" class="gt_row gt_right">4.90</td>
<td headers="V1 - equivalent-combinations  5k^m" class="gt_row gt_right">135</td>
</tr>
</tbody>
</table>
</div>
<p>The histogram of the number of symbols is obtain appling the plot
method.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">q.test</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="user-guide_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="the-q-test-using-a-sf-object">The Q-test using a sf object<a class="anchor" aria-label="anchor" href="#the-q-test-using-a-sf-object"></a>
</h3>
<ul>
<li>A sf object <span class="citation">(<a href="#ref-pebesma2018">Pebesma 2018</a>)</span> or a data frame can be
used as input of the function:</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html" class="external-link">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spherical geometry (s2) switched off</span></span>
<span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">GenderRatio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Mal2Fml</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">GenderRatio</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"men"</span>,<span class="st">"woman"</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">provinces_spain</span><span class="op">$</span><span class="va">GenderRatio</span></span>
<span><span class="va">q.test.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.test.html">Q.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>The method show the histogram of the number of symbols</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">q.test.sf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="user-guide_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="qmap-test">QMap-test<a class="anchor" aria-label="anchor" href="#qmap-test"></a>
</h2>
<ul>
<li>The function obtain the test for maps comparison publish in <span class="citation">Ruiz, López, and Páez (<a href="#ref-Ruiz2012b">2012</a>)</span>
</li>
</ul>
<p>The next code generate two qualitative spatial process with different
levels of spatial dependence and the Q-Map is apply.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">/</span><span class="fl">6</span>,<span class="fl">2</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">rho</span> <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="va">QY1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span>
<span><span class="va">rho</span> <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="va">QY2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dgp.spq.html">dgp.spq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, listw <span class="op">=</span> <span class="va">listw</span>, rho <span class="op">=</span> <span class="va">rho</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">QY1</span>,<span class="va">QY2</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">r</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">QY1</span> <span class="op">+</span> <span class="va">QY2</span></span>
<span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dtmaxknn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">qmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Q.map.test.html">Q.map.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">dt</span>, coor <span class="op">=</span> <span class="va">coor</span>, m <span class="op">=</span> <span class="va">m</span>, r <span class="op">=</span> <span class="va">r</span>, type <span class="op">=</span><span class="st">"combinations"</span>, control <span class="op">=</span> <span class="va">control</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in Q.map.test(formula = formula, data = dt, coor = coor, m = m, : The</span></span>
<span><span class="co">#&gt; ratio between the number of symbolized observations and the number of symbols</span></span>
<span><span class="co">#&gt; is lower than 5.</span></span></code></pre></div>
<ul>
<li>The output of id an object of the classes <strong>qmap</strong> and
<strong>htest</strong>
</li>
</ul>
<div class="section level4">
<h4 id="methods-for-qmap-class">Methods for qmap class<a class="anchor" aria-label="anchor" href="#methods-for-qmap-class"></a>
</h4>
<ul>
<li>The qmap object is a list with two elements. Each element is an
object of the class <strong>htext</strong>
</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">qmap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Q-Map test of Equivalence for qualitative data.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Symbols type: combinations</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Ratio Symbolized observations/Num symbols = 4.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  QY1 and QY2</span></span>
<span><span class="co">#&gt; QE = 135.12, df = 9, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: two.sided</span></span></code></pre></div>
<ul>
<li>The method obtains the distribution of symbols with the confidence
intervals specified by the user.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">qmap</span>, ci<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="runs-test">Runs test<a class="anchor" aria-label="anchor" href="#runs-test"></a>
</h2>
<p>The spatial runs test compute the global and local test for spatial
independence of a categorical spatial data set <span class="citation">(<a href="#ref-ruiz2021">Ruiz, López, and Páez
2021</a>)</span>.</p>
<p><strong>Definition of spatial run:</strong></p>
<p>In this section define the concepts of spatial encoding and runs, and
construct the main statistics necessary for testing spatial homogeneity
of categorical variables. In order to develop a general theoretical
setting, let us consider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>s</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>s</mi><mo>∈</mo><mi>S</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\{X_s\}_{s \in S}</annotation></semantics></math>
to be the categorical spatial process of interest with Q different
categories, where S is a set of coordinates.</p>
<p><strong>Spatial encoding:</strong></p>
<p>For a location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>∈</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s \in S</annotation></semantics></math>
denote by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>s</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>s</mi><msub><mi>n</mi><mi>s</mi></msub></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">N_s = \{s_1,s_2 ...,s_{n_s}\}</annotation></semantics></math>
the set of neighbours according to the interaction scheme W, which are
ordered from lesser to higher Euclidean distance with respect to
location s.</p>
<p>The sequence as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><msub><mi>s</mi><mi>i</mi></msub></msub><mo>,</mo><msub><mi>X</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mo>,</mo><msub><mi>X</mi><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{s_i} , X_{s_i+1},...,, X_{s_i+r}</annotation></semantics></math>
its elements have the same value (or are identified by the same class)
is called a <strong>spatial run</strong> at location s of length r.</p>
<p><strong>The spatial run statistic:</strong></p>
<p>The total number of runs is defined as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msup><mi>R</mi><mi>Q</mi></msup><mo>=</mo><mi>n</mi><mo>+</mo><munder><mo>∑</mo><mrow><mi>s</mi><mo>∈</mo><mi>S</mi></mrow></munder><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>s</mi></msub></munderover><msubsup><mi>I</mi><mi>j</mi><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">SR^Q=n+\sum_{s \in S}\sum_{j=1}^{n_s}I_j^s</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>I</mi><mi>j</mi><mi>s</mi></msubsup><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mi>i</mi><mi>f</mi><mspace width="0.222em"></mspace><msub><mi>X</mi><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>−</mo><mn>1</mn></mrow></msub><mo>≠</mo><msub><mi>X</mi><msub><mi>s</mi><mi>j</mi></msub></msub><mspace width="0.222em"></mspace><mtext mathvariant="normal">and 0 otherwise</mtext></mrow><annotation encoding="application/x-tex">I_j^s = 1 \ if \ X_{s_j-1} \neq X_{s_j} \ \text{and 0 otherwise}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>n</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">j=1,2,...,n_s</annotation></semantics></math>
Following result by the Central Limit Theorem, the asymtotical
distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msup><mi>R</mi><mi>Q</mi></msup></mrow><annotation encoding="application/x-tex">SR^Q</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msup><mi>R</mi><mi>Q</mi></msup><mo>=</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>S</mi><msup><mi>R</mi><mi>Q</mi></msup></mrow></msub><mo>,</mo><msub><mi>σ</mi><mrow><mi>S</mi><msup><mi>R</mi><mi>Q</mi></msup></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">SR^Q = N(\mu_{SR^Q},\sigma_{SR^Q})</annotation></semantics></math></p>
<p>In the one-tailed case, we must distinguish the lower-tailed test and
the upper-tailed, which are associated with homogeneity and
heterogeneity respectively. In the case of the lower-tailed test, the
following hypotheses are used:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>s</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>s</mi><mo>∈</mo><mi>S</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\{X_s\}_{s \in S}</annotation></semantics></math>
is i.i.d.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>:
The spatial distribution of the values of the categorical variable is
more homogeneous than under the null hypothesis (according to the fixed
association scheme).</p>
<p>In the upper-tailed test, the following hypotheses are used:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>X</mi><mi>s</mi></msub><msub><mo stretchy="false" form="postfix">}</mo><mrow><mi>s</mi><mo>∈</mo><mi>S</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0:\{X_s\}_{s \in S}</annotation></semantics></math>
is i.i.d.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>:
The spatial distribution of the values of the categorical variable is
more heterogeneous than under the null hypothesis (according to the
fixed association scheme).</p>
<p>These hypotheses provide a decision rule regarding the degree of
homogeneity in the spatial distribution of the values of the spatial
categorical random variable.</p>
<div class="section level3">
<h3 id="global-runs-test">Global Runs test<a class="anchor" aria-label="anchor" href="#global-runs-test"></a>
</h3>
<ul>
<li>The function <strong>sp.runs.test</strong> obtain the spatial runs
test.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">srq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sp.runs.test.html">sp.runs.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, listw <span class="op">=</span> <span class="va">listw</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>The output of this function is a object of the classes
<strong>sprunstest</strong> and <strong>htest</strong>
</li>
</ul>
<div class="section level4">
<h4 id="methods-for-spruntest-class">Methods for spruntest class<a class="anchor" aria-label="anchor" href="#methods-for-spruntest-class"></a>
</h4>
<ul>
<li>The <strong>spqdep</strong> has two methods for this class y </li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">srq</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Runs test of spatial dependence for qualitative data. Asymptotic</span></span>
<span><span class="co">#&gt;  version</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  mxf</span></span>
<span><span class="co">#&gt; sp.runs test = -1.4204, p-value = 0.1555</span></span>
<span><span class="co">#&gt; alternative hypothesis: two.sided</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;          Total runs     Mean total runs Variance total runs </span></span>
<span><span class="co">#&gt;            269.0000            285.5152            135.1986</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">srq</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="the-local-runs-test">The local Runs test<a class="anchor" aria-label="anchor" href="#the-local-runs-test"></a>
</h3>
<ul>
<li>The function <strong>local.sp.runs.test</strong> obtain the local
tests based on runs.</li>
</ul>
<div class="section level4">
<h4 id="asymptotic-version">Asymptotic version<a class="anchor" aria-label="anchor" href="#asymptotic-version"></a>
</h4>
<ul>
<li>Asymptotic version</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lsrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/local.sp.runs.test.html">local.sp.runs.test</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">fx</span>, listw <span class="op">=</span> <span class="va">listw</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>The method list the statistic of each observation (points or
regions)</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lsrq</span><span class="op">)</span></span>
<span><span class="co">#&gt;     runs.i      E.i     Std.i    z.value    p.value</span></span>
<span><span class="co">#&gt; 1        2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 2        4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 3        3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 4        3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 5        4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 6        4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 7        2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 8        2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 9        3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 10       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 11       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 12       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 13       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 14       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 15       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 16       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 17       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 18       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 19       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 20       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 21       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 22       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 23       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 24       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 25       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 26       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 27       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 28       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 29       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 30       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 31       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 32       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 33       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 34       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 35       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 36       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 37       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 38       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 39       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 40       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 41       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 42       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 43       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 44       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 45       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 46       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 47       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 48       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 49       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 50       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 51       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 52       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 53       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 54       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 55       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 56       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 57       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 58       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 59       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 60       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 61       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 62       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 63       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 64       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 65       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 66       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 67       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 68       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 69       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 70       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 71       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 72       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 73       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 74       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 75       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 76       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 77       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 78       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 79       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 80       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 81       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 82       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 83       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 84       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 85       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 86       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 87       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 88       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 89       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 90       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 91       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 92       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 93       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 94       4 2.855152 0.8722689  1.3124950 0.90532341</span></span>
<span><span class="co">#&gt; 95       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 96       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 97       3 2.855152 0.8722689  0.1660594 0.56594492</span></span>
<span><span class="co">#&gt; 98       2 2.855152 0.8722689 -0.9803761 0.16345026</span></span>
<span><span class="co">#&gt; 99       1 2.855152 0.8722689 -2.1268116 0.01671787</span></span>
<span><span class="co">#&gt; 100      2 2.855152 0.8722689 -0.9803761 0.16345026</span></span></code></pre></div>
<ul>
<li>The method identify the localization with values of local test
significant.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lsrq</span>, sig <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="monte-carlo-local-runs-test">Monte Carlo local runs test<a class="anchor" aria-label="anchor" href="#monte-carlo-local-runs-test"></a>
</h4>
<ul>
<li>The Monte Carlo distribution ot the local test using a sf
object</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"provinces_spain"</span><span class="op">)</span></span>
<span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">provinces_spain</span>,<span class="st">"Spatial"</span><span class="op">)</span>, queen <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they</span></span>
<span><span class="co">#&gt; are planar</span></span>
<span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Mal2Fml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Mal2Fml</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Mal2Fml</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"men"</span>,<span class="st">"woman"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">[</span><span class="st">"Mal2Fml"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Mal2Fml</span></span>
<span><span class="co"># Boots Version</span></span>
<span><span class="va">lsrq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/local.sp.runs.test.html">local.sp.runs.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, listw <span class="op">=</span> <span class="va">listw</span>, distr <span class="op">=</span><span class="st">"bootstrap"</span>, nsim <span class="op">=</span> <span class="fl">199</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lsrq</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span>, sig <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-22-2.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-scan-test">The Scan test<a class="anchor" aria-label="anchor" href="#the-scan-test"></a>
</h2>
<ul>
<li><p>Two of the scan tests to identify clusters can be apply to test
spatial structure in qualitative spatial processes.</p></li>
<li><p>The scan test don’t need pre-define the classical W conectivity
matrix.</p></li>
<li><p>See <span class="citation">Kanaroglou (<a href="#ref-Kanaroglou2016">2016</a>)</span></p></li>
<li><p>The scan tests contrasts the null of independence of a spatial
qualitative process and give additional information indicating one (or
perhaps more) spatial cluster(s).</p></li>
<li><p>The scan tests don’t have asymptotic distribution. The
significance is obtained by permutational resampling.</p></li>
<li><p>The output of the scan function is an object of the classes
<strong>scantest</strong> and <strong>htest</strong></p></li>
</ul>
<div class="section level3">
<h3 id="scan-bernoulli">Scan bernoulli<a class="anchor" aria-label="anchor" href="#scan-bernoulli"></a>
</h3>
<ul>
<li>For qualitative spatial process with two categories the bernoulli
scan test is obtain with the next code</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Mal2Fml</span></span>
<span><span class="va">scan.spain</span> <span class="op">&lt;-</span> <span class="fu">spqdep</span><span class="fu">::</span><span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, </span>
<span>                                case<span class="op">=</span><span class="st">"men"</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan.spain</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Scan test. Distribution: bernoulli</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Mal2Fml</span></span>
<span><span class="co">#&gt; scan-loglik = 6.0359, p-value = 0.07</span></span>
<span><span class="co">#&gt; alternative hypothesis: High</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;                                        </span></span>
<span><span class="co">#&gt; Total observations in the MLC =   17.00</span></span>
<span><span class="co">#&gt; Expected cases in the MLC =       11.84</span></span>
<span><span class="co">#&gt; Observed cases in the MLC =       16.00</span></span></code></pre></div>
<div class="section level4">
<h4 id="scan-test-with-flexible-windows">Scan test with flexible windows<a class="anchor" aria-label="anchor" href="#scan-test-with-flexible-windows"></a>
</h4>
<ul>
<li>The flexible windows is an option. Note that is slow. Consider
maximum nv of 12.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="va">provinces_spain</span>, queen <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they</span></span>
<span><span class="co">#&gt; are planar</span></span>
<span><span class="va">scan.spain</span> <span class="op">&lt;-</span> <span class="fu">spqdep</span><span class="fu">::</span><span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, </span>
<span>                                case<span class="op">=</span><span class="st">"men"</span>, nsim <span class="op">=</span> <span class="fl">99</span>, windows <span class="op">=</span> <span class="st">"flexible"</span>, </span>
<span>                                listw <span class="op">=</span> <span class="va">listw</span>, nv <span class="op">=</span> <span class="fl">6</span>, distr <span class="op">=</span> <span class="st">"bernoulli"</span><span class="op">)</span></span>
<span><span class="co">#&gt; +++++end</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan.spain</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Scan test. Distribution: bernoulli</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Mal2Fml</span></span>
<span><span class="co">#&gt; scan-loglik = 1.9464, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: High</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;                                         </span></span>
<span><span class="co">#&gt; Total observations in the MLC =     6.00</span></span>
<span><span class="co">#&gt; Expected cases in the MLC =       370.74</span></span>
<span><span class="co">#&gt; Observed cases in the MLC =         6.00</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="scan-multinomial">Scan multinomial<a class="anchor" aria-label="anchor" href="#scan-multinomial"></a>
</h3>
<ul>
<li>In case of a spatial process with three or more categories</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span></span>
<span><span class="va">scan.fastfood</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scan.test.html">scan.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, nsim <span class="op">=</span> <span class="fl">99</span>, distr <span class="op">=</span> <span class="st">"multinomial"</span>, windows <span class="op">=</span> <span class="st">"elliptic"</span>, </span>
<span>                           nv <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scan.fastfood</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Scan test. Distribution: multinomial</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Type</span></span>
<span><span class="co">#&gt; scan-loglik = 15.506, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;                  H     P     S Sum</span></span>
<span><span class="co">#&gt; cases.expect 13.48 14.86 14.66  43</span></span>
<span><span class="co">#&gt; cases.observ 16.00  1.00 26.00  43</span></span></code></pre></div>
<div class="section level4">
<h4 id="methods-for-scan-test">Methods for scan test<a class="anchor" aria-label="anchor" href="#methods-for-scan-test"></a>
</h4>
<ul>
<li>Two method can be used with <strong>scantest</strong> objects: and
</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scan.fastfood</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of data:</span></span>
<span><span class="co">#&gt; Distribution....................: multinomial</span></span>
<span><span class="co">#&gt; Number of locations.............: 877</span></span>
<span><span class="co">#&gt; Total number of cases...........: 877</span></span>
<span><span class="co">#&gt; Names of cathegories...........: H P S</span></span>
<span><span class="co">#&gt; Total cases per category........: 275 303 299</span></span>
<span><span class="co">#&gt; Percent cases per category......: 0.31 0.35 0.34</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scan statistic:</span></span>
<span><span class="co">#&gt; Total cases in the MLC.........: 43</span></span>
<span><span class="co">#&gt; Names of cathegories...........: H P S</span></span>
<span><span class="co">#&gt; Observed cases in the MLC......: 13.48 14.86 14.66</span></span>
<span><span class="co">#&gt; Expected cases in the MLC......: 16 1 26</span></span>
<span><span class="co">#&gt; Value of statistic (loglik ratio)....: 15.5058</span></span>
<span><span class="co">#&gt; p-value........................: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; IDs of cluster detect:</span></span>
<span><span class="co">#&gt; Location IDs included.....:  68 849 152 499 630 763 827 765 617 600 607 48 58 588 743 843 74 122 750 115 645 61 226 796 876 699 610 597 596 721 751 53 186 659 778 63 106 229 585 738 612 131 208</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Secondary Scan statistic. Number 1 </span></span>
<span><span class="co">#&gt; Total cases in secondary cluster......:  16 </span></span>
<span><span class="co">#&gt; Names of cathegories.................: H P S</span></span>
<span><span class="co">#&gt; Percent per category total...........: 0.31 0.35 0.34</span></span>
<span><span class="co">#&gt; Percent per category inside cluster..: 0.25 0.5 0.25</span></span>
<span><span class="co">#&gt; Value of statisitic (loglik ratio)....: 11.5285</span></span>
<span><span class="co">#&gt; p-value.........................: 0.1</span></span>
<span><span class="co">#&gt; Location IDs included..................:  677 311 781 128 108 436 551 576 21 374 319 717 561 6 629 547</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Secondary Scan statistic. Number 2 </span></span>
<span><span class="co">#&gt; Total cases in secondary cluster......:  7 </span></span>
<span><span class="co">#&gt; Names of cathegories.................: H P S</span></span>
<span><span class="co">#&gt; Percent per category total...........: 0.31 0.35 0.34</span></span>
<span><span class="co">#&gt; Percent per category inside cluster..: 0.14 0.29 0.57</span></span>
<span><span class="co">#&gt; Value of statisitic (loglik ratio)....: 7.0038</span></span>
<span><span class="co">#&gt; p-value.........................: 0.96</span></span>
<span><span class="co">#&gt; Location IDs included..................:  158 709 335 801 749 545 856</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Secondary Scan statistic. Number 3 </span></span>
<span><span class="co">#&gt; Total cases in secondary cluster......:  17 </span></span>
<span><span class="co">#&gt; Names of cathegories.................: H P S</span></span>
<span><span class="co">#&gt; Percent per category total...........: 0.31 0.35 0.34</span></span>
<span><span class="co">#&gt; Percent per category inside cluster..: 0.35 0.35 0.29</span></span>
<span><span class="co">#&gt; Value of statisitic (loglik ratio)....: 6.8747</span></span>
<span><span class="co">#&gt; p-value.........................: 0.98</span></span>
<span><span class="co">#&gt; Location IDs included..................:  521 782 162 643 297 220 267 265 104 530 312 523 783 157 531 848 680</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Secondary Scan statistic. Number 4 </span></span>
<span><span class="co">#&gt; Total cases in secondary cluster......:  17 </span></span>
<span><span class="co">#&gt; Names of cathegories.................: H P S</span></span>
<span><span class="co">#&gt; Percent per category total...........: 0.31 0.35 0.34</span></span>
<span><span class="co">#&gt; Percent per category inside cluster..: 0.47 0.29 0.24</span></span>
<span><span class="co">#&gt; Value of statisitic (loglik ratio)....: 6.7961</span></span>
<span><span class="co">#&gt; p-value.........................: 0.98</span></span>
<span><span class="co">#&gt; Location IDs included..................:  190 837 555 711 646 216 17 390 742 563 307 4 353 197 254 192 66</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Secondary Scan statistic. Number 5 </span></span>
<span><span class="co">#&gt; Total cases in secondary cluster......:  10 </span></span>
<span><span class="co">#&gt; Names of cathegories.................: H P S</span></span>
<span><span class="co">#&gt; Percent per category total...........: 0.31 0.35 0.34</span></span>
<span><span class="co">#&gt; Percent per category inside cluster..: 0.4 0.2 0.4</span></span>
<span><span class="co">#&gt; Value of statisitic (loglik ratio)....: 6.5951</span></span>
<span><span class="co">#&gt; p-value.........................: 0.98</span></span>
<span><span class="co">#&gt; Location IDs included..................:  78 365 668 228 170 857 306 708 651 187</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scan.spain</span>, sf <span class="op">=</span> <span class="va">provinces_spain</span><span class="op">)</span></span></code></pre></div>
<p><img src="user-guide_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">)</span></span>
<span><span class="co"># plot(scan.fastfood, sf = FastFood.sf)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="similarity-test">Similarity test<a class="anchor" aria-label="anchor" href="#similarity-test"></a>
</h2>
<p><span class="citation">Farber, Marin, and Paez (<a href="#ref-farber_testing_2015">2015</a>)</span> develop the similarity
test.</p>
<p>The function calculates the similarity test for both asymptotic
distribution and permutational resampling.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">FastFood.sf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">listw</span> <span class="op">&lt;-</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html" class="external-link">knearneigh</a></span><span class="op">(</span><span class="va">coor</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Type</span></span>
<span><span class="va">similarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity.test.html">similarity.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">FastFood.sf</span>, listw <span class="op">=</span> <span class="va">listw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">similarity</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Similarity test of spatial dependence for qualitative data.</span></span>
<span><span class="co">#&gt;  Distribution: asymptotic</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  Type</span></span>
<span><span class="co">#&gt; Similarity-test = -5.4476, p-value = 5.105e-08</span></span>
<span><span class="co">#&gt; alternative hypothesis: two.sided</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="join-count-tests">Join-count tests<a class="anchor" aria-label="anchor" href="#join-count-tests"></a>
</h2>
<ul>
<li>The functions of the <strong>spdep</strong> R-package have been
<strong>wrapped</strong> for Bernoulli and Multinomial distributions.
Asymptotic or Monte Carlo distributions (permutations) can be used to
evaluate the signification of the tests.</li>
</ul>
<div class="section level3">
<h3 id="asymptotic-distribution">Asymptotic distribution<a class="anchor" aria-label="anchor" href="#asymptotic-distribution"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>,<span class="fl">19</span>,<span class="fl">22.5</span>,<span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">provinces_spain</span><span class="op">$</span><span class="va">Older</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"middle"</span>,<span class="st">"high"</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">Older</span> <span class="op">+</span> <span class="va">Mal2Fml</span></span>
<span><span class="va">jc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jc.test.html">jc.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, distr <span class="op">=</span> <span class="st">"asymptotic"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they</span></span>
<span><span class="co">#&gt; are planar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jc1</span><span class="op">)</span></span></code></pre></div>
<div id="hyffzpwhxh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hyffzpwhxh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hyffzpwhxh thead, #hyffzpwhxh tbody, #hyffzpwhxh tfoot, #hyffzpwhxh tr, #hyffzpwhxh td, #hyffzpwhxh th {
  border-style: none;
}

#hyffzpwhxh p {
  margin: 0;
  padding: 0;
}

#hyffzpwhxh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hyffzpwhxh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hyffzpwhxh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hyffzpwhxh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hyffzpwhxh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hyffzpwhxh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hyffzpwhxh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hyffzpwhxh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hyffzpwhxh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hyffzpwhxh .gt_spanner_row {
  border-bottom-style: hidden;
}

#hyffzpwhxh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hyffzpwhxh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hyffzpwhxh .gt_from_md > :first-child {
  margin-top: 0;
}

#hyffzpwhxh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hyffzpwhxh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hyffzpwhxh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hyffzpwhxh .gt_row_group_first td {
  border-top-width: 2px;
}

#hyffzpwhxh .gt_row_group_first th {
  border-top-width: 2px;
}

#hyffzpwhxh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hyffzpwhxh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hyffzpwhxh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hyffzpwhxh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hyffzpwhxh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hyffzpwhxh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hyffzpwhxh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hyffzpwhxh .gt_left {
  text-align: left;
}

#hyffzpwhxh .gt_center {
  text-align: center;
}

#hyffzpwhxh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hyffzpwhxh .gt_font_normal {
  font-weight: normal;
}

#hyffzpwhxh .gt_font_bold {
  font-weight: bold;
}

#hyffzpwhxh .gt_font_italic {
  font-style: italic;
}

#hyffzpwhxh .gt_super {
  font-size: 65%;
}

#hyffzpwhxh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hyffzpwhxh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hyffzpwhxh .gt_indent_1 {
  text-indent: 5px;
}

#hyffzpwhxh .gt_indent_2 {
  text-indent: 10px;
}

#hyffzpwhxh .gt_indent_3 {
  text-indent: 15px;
}

#hyffzpwhxh .gt_indent_4 {
  text-indent: 20px;
}

#hyffzpwhxh .gt_indent_5 {
  text-indent: 25px;
}

#hyffzpwhxh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hyffzpwhxh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>JoinCount Spatial Tests (asymptotic)</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="pairs">pairs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="z-value">z-value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pvalue">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Joincount">Joincount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Expected">Expected</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Variance">Variance</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Older - multinomial - alternative: greater - Join count test under nonfree sampling">Older - multinomial - alternative: greater - Join count test under nonfree sampling</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">high:high</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−0.56</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.71077</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">14</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">15.71</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">9.48</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">low:low</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−0.93</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.82392</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">7</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">9.34</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">6.35</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">middle:middle</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−0.88</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.81070</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">13</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">15.71</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">9.48</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">low:high</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−0.47</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.68162</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">24</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">25.88</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">15.78</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">middle:high</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−1.21</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.88738</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">28</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">33.27</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">18.88</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">middle:low</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−0.22</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.58727</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">25</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">25.88</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">15.78</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">Jtot</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−1.29</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.90190</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">77</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">85.02</td>
<td headers="Older - multinomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">38.52</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="6" class="gt_group_heading" scope="colgroup" id="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling">Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">men-men</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−2.17</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.98504</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">60</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">68.39</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">14.92</td>
</tr>
<tr>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">woman-woman</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">2.11</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.01740</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">13</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">8.01</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">5.59</td>
</tr>
<tr>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  pairs" class="gt_row gt_left">men-woman</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  z-value" class="gt_row gt_right">−2.47</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  pvalue" class="gt_row gt_right">0.99333</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Joincount" class="gt_row gt_right">38</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Expected" class="gt_row gt_right">49.39</td>
<td headers="Mal2Fml - binomial - alternative: greater - Join count test under nonfree sampling  Variance" class="gt_row gt_right">21.19</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="monte-carlo-distribution">Monte Carlo distribution<a class="anchor" aria-label="anchor" href="#monte-carlo-distribution"></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jc.test.html">jc.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">f1</span>, data <span class="op">=</span> <span class="va">provinces_spain</span>, distr <span class="op">=</span> <span class="st">"mc"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes that they</span></span>
<span><span class="co">#&gt; are planar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">jc1</span><span class="op">)</span></span></code></pre></div>
<div id="dkrtpzdols" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dkrtpzdols table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dkrtpzdols thead, #dkrtpzdols tbody, #dkrtpzdols tfoot, #dkrtpzdols tr, #dkrtpzdols td, #dkrtpzdols th {
  border-style: none;
}

#dkrtpzdols p {
  margin: 0;
  padding: 0;
}

#dkrtpzdols .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dkrtpzdols .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dkrtpzdols .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dkrtpzdols .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dkrtpzdols .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dkrtpzdols .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dkrtpzdols .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dkrtpzdols .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dkrtpzdols .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dkrtpzdols .gt_spanner_row {
  border-bottom-style: hidden;
}

#dkrtpzdols .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dkrtpzdols .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dkrtpzdols .gt_from_md > :first-child {
  margin-top: 0;
}

#dkrtpzdols .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dkrtpzdols .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dkrtpzdols .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dkrtpzdols .gt_row_group_first td {
  border-top-width: 2px;
}

#dkrtpzdols .gt_row_group_first th {
  border-top-width: 2px;
}

#dkrtpzdols .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dkrtpzdols .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dkrtpzdols .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dkrtpzdols .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dkrtpzdols .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkrtpzdols .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dkrtpzdols .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkrtpzdols .gt_left {
  text-align: left;
}

#dkrtpzdols .gt_center {
  text-align: center;
}

#dkrtpzdols .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dkrtpzdols .gt_font_normal {
  font-weight: normal;
}

#dkrtpzdols .gt_font_bold {
  font-weight: bold;
}

#dkrtpzdols .gt_font_italic {
  font-style: italic;
}

#dkrtpzdols .gt_super {
  font-size: 65%;
}

#dkrtpzdols .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dkrtpzdols .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dkrtpzdols .gt_indent_1 {
  text-indent: 5px;
}

#dkrtpzdols .gt_indent_2 {
  text-indent: 10px;
}

#dkrtpzdols .gt_indent_3 {
  text-indent: 15px;
}

#dkrtpzdols .gt_indent_4 {
  text-indent: 20px;
}

#dkrtpzdols .gt_indent_5 {
  text-indent: 25px;
}

#dkrtpzdols .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dkrtpzdols div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>JoinCount Spatial Tests (Monte Carlo)</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="pairs">pairs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="pvalue">pvalue</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Joincount">Joincount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Expected">Expected</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Variance">Variance</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)">Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">high:high</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.50900</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">14</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">13.77</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">10.80</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">low:low</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.68200</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">7</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">8.33</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">6.31</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">middle:middle</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.53800</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">13</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">13.86</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">10.40</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">low:high</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.40700</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">24</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">22.89</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">16.40</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">middle:high</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.68300</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">28</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">29.55</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">18.26</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">middle:low</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.25300</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">25</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">22.60</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">16.01</td>
</tr>
<tr>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pairs" class="gt_row gt_left">Jtot</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  pvalue" class="gt_row gt_right">0.38900</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Joincount" class="gt_row gt_right">77</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Expected" class="gt_row gt_right">75.03</td>
<td headers="Older - multinomial - alternative: greater - Monte-Carlo simulation of
        join-count statistic (nonfree sampling)  Variance" class="gt_row gt_right">22.51</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_group_heading" scope="colgroup" id="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic">Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic</th>
    </tr>
<tr class="gt_row_group_first">
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  pairs" class="gt_row gt_left">men-men</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  pvalue" class="gt_row gt_right">0.52150</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  Joincount" class="gt_row gt_right">60</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  Expected" class="gt_row gt_right">60.34</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  Variance" class="gt_row gt_right">23.29</td>
</tr>
<tr>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  pairs" class="gt_row gt_left">woman-woman</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  pvalue" class="gt_row gt_right">0.01750</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  Joincount" class="gt_row gt_right">13</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  Expected" class="gt_row gt_right">7.10</td>
<td headers="Mal2Fml - binomial - alternative: greater - Monte-Carlo simulation of join-count statistic  Variance" class="gt_row gt_right">5.95</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-farber_testing_2015" class="csl-entry">
Farber, S., M. R. Marin, and A. Paez. 2015. <span>“Testing for
<span>Spatial</span> <span>Independence</span> <span>Using</span>
<span>Similarity</span> <span>Relations</span>.”</span> <em>Geographical
Analysis</em> 47 (2): 97–120. <a href="https://doi.org/10.1111/gean.12044" class="external-link">https://doi.org/10.1111/gean.12044</a>.
</div>
<div id="ref-Kanaroglou2016" class="csl-entry">
Kanaroglou, Pavlos. 2016. <em>Spatial Analysis in Health Geography</em>.
Routledge. <a href="https://doi.org/10.4324/9781315610252" class="external-link">https://doi.org/10.4324/9781315610252</a>.
</div>
<div id="ref-lopez2012" class="csl-entry">
López, Fernando A, and Antonio Páez. 2012. <span>“Distribution-Free
Inference for q (m) Based on Permutational Bootstrapping: An Application
to the Spatial Co-Location Pattern of Firms in Madrid.”</span>
<em>Estad<span>ı́</span>stica Espa<span>ñ</span>ola</em> 54 (177):
135–56.
</div>
<div id="ref-paezSpatioTemporalAnalysisEnvironmental2021" class="csl-entry">
Paez, Antonio, Fernando A. Lopez, Tatiane Menezes, Renata Cavalcanti,
and Maira Galdino da Rocha Pitta. 2021. <span>“A
<span>Spatio</span>-<span>Temporal</span> <span>Analysis</span> of the
<span>Environmental</span> <span>Correlates</span> of
<span>COVID</span>-19 <span>Incidence</span> in
<span>Spain</span>.”</span> <em>Geographical Analysis</em> 53 (3):
397–421. <a href="https://doi.org/10.1111/gean.12241" class="external-link">https://doi.org/10.1111/gean.12241</a>.
</div>
<div id="ref-pebesma2018" class="csl-entry">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R:
Standardized Support for Spatial Vector Data</span>.”</span>
<em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-ruiz2010" class="csl-entry">
Ruiz, Manuel, Fernando López, and Antonio Páez. 2010. <span>“Testing for
Spatial Association of Qualitative Data Using Symbolic Dynamics.”</span>
<em>Journal of Geographical Systems</em> 12 (3): 281–309. <a href="https://doi.org/10.1007/s10109-009-0100-1" class="external-link">https://doi.org/10.1007/s10109-009-0100-1</a>.
</div>
<div id="ref-Ruiz2012b" class="csl-entry">
———. 2012. <span>“Comparison of Thematic Maps Using Symbolic
Entropy.”</span> <em>International Journal of Geographical Information
Science</em> 26 (3): 413–39. <a href="https://doi.org/10.1080/13658816.2011.586327" class="external-link">https://doi.org/10.1080/13658816.2011.586327</a>.
</div>
<div id="ref-ruiz2021" class="csl-entry">
———. 2021. <span>“A Test for Global and Local Homogeneity of Categorical
Data Based on Spatial Runs.”</span> <em>Working Paper</em>.
</div>
<div id="ref-upton1985" class="csl-entry">
Upton, Graham JG, and Bernard Fingleton. 1985. <em>Spatial Data Analysis
by Example: Categorical and Directional Data</em>. Wiley.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Fernando Lopez, Roman Minguez, Antonio Paez, Manuel Ruiz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
